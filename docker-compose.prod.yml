services:
  demo:
    image: ${DOCKER_USERNAME}/ligitabl-demo:${IMAGE_TAG:-latest}
    container_name: ligitabl-demo
    restart: unless-stopped
    environment:
      # Server config
      SERVER_PORT: 8080

      # JVM options (small footprint since no DB)
      JAVA_OPTS: >-
        -Xmx256m
        -Xms128m
        -XX:+UseG1GC
        -XX:MaxGCPauseMillis=200

      # nginx-proxy integration (handles both root and www)
      VIRTUAL_HOST: ${VIRTUAL_HOST}
      VIRTUAL_PORT: 8080
      LETSENCRYPT_HOST: ${LETSENCRYPT_HOST}
      LETSENCRYPT_EMAIL: ${LETSENCRYPT_EMAIL}

    networks:
      - nginx

    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8080"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 30s

    logging:
      driver: "json-file"
      options:
        max-size: "5m"
        max-file: "2"

networks:
  nginx:
    external: true