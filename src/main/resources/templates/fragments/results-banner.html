<!-- Results Banner Fragment -->
<!-- Default fragment uses /predictions/me -->
<div th:fragment="results-banner(result)" th:if="${result != null}">
    <div th:replace="~{fragments/results-banner :: results-banner-base(result=${result}, baseUrl='/predictions/me')}"></div>
</div>

<!-- Fragment for /predictions/user/me -->
<div th:fragment="results-banner-user(result)" th:if="${result != null}">
    <div th:replace="~{fragments/results-banner :: results-banner-base(result=${result}, baseUrl='/predictions/user/me')}"></div>
</div>

<!-- Base fragment with configurable URL -->
<div th:fragment="results-banner-base(result, baseUrl)" th:if="${result != null}">
    <div class="bg-gradient-to-r from-green-50 to-blue-50 border-2 border-green-200 rounded-lg p-5 shadow-sm mb-6"
         th:attr="data-result-round=${result.round}">
        <!-- Header -->
        <div class="flex items-center justify-between mb-3">
            <div class="flex items-center">
                <span class="text-2xl mr-2">ğŸ‰</span>
                <h3 class="text-lg font-bold text-gray-900">
                    Gameweek <span th:text="${result.round}">18</span> Results Available!
                </h3>
            </div>
            <button type="button"
                    data-dismiss-results-banner="true"
                    class="text-gray-400 hover:text-gray-600 transition text-xl font-bold">
                âœ•
            </button>
        </div>

        <!-- Score & Position -->
        <div class="mb-4">
            <p class="text-base text-gray-700">
                You scored <span class="font-bold text-indigo-600" th:text="${result.score}">156</span> points
                <span th:if="${result.movement != null && result.movement != 0}">
                    <span th:if="${result.movement > 0}" class="text-green-600 font-semibold">
                        (â†‘ <span th:text="${result.movement}">3</span> positions)
                    </span>
                    <span th:if="${result.movement < 0}" class="text-red-600 font-semibold">
                        (â†“ <span th:text="${T(java.lang.Math).abs(result.movement)}">2</span> positions)
                    </span>
                </span>
            </p>
        </div>

        <!-- Distribution (2 lines) -->
        <div class="space-y-1 mb-4">
            <!-- Line 1: Perfect + Close Calls -->
            <div class="flex items-center text-sm text-gray-700">
                <span class="mr-3">
                    <span class="text-2xl">ğŸ¯</span>
                    <span class="font-bold text-green-600 text-lg ml-1" th:text="${result.hitDistribution.perfect}">5</span>
                    <span class="ml-1 font-semibold">perfect!</span>
                </span>
                <span class="text-gray-400 mx-2">â€¢</span>
                <span>
                    <span class="text-lg">ğŸ¤</span>
                    <span class="font-semibold ml-1" th:text="${result.hitDistribution.closeCalls}">8</span>
                    <span class="ml-1">close calls (Â±1-2)</span>
                </span>
            </div>

            <!-- Line 2: Near Misses + Big Misses -->
            <div class="flex items-center text-sm text-gray-700">
                <span class="mr-3">
                    <span class="text-lg">ğŸ¤·</span>
                    <span class="font-semibold ml-1" th:text="${result.hitDistribution.nearMisses}">5</span>
                    <span class="ml-1">near misses (Â±3-5)</span>
                </span>
                <span class="text-gray-400 mx-2">â€¢</span>
                <span>
                    <span class="text-lg">ğŸ˜…</span>
                    <span class="font-semibold ml-1" th:text="${result.hitDistribution.bigMisses}">2</span>
                    <span class="ml-1">big misses (Â±6+)</span>
                </span>
            </div>
        </div>

        <!-- Action Button -->
        <div class="flex justify-center">
            <a th:href="@{${baseUrl}(round=${result.round})}"
               th:attr="hx-get=@{${baseUrl}(round=${result.round})}"
               hx-target="#prediction-page"
               hx-swap="outerHTML swap:300ms show:window:top"
               hx-push-url="true"
               data-dismiss-results-banner="true"
               class="inline-flex items-center px-4 py-2 bg-indigo-600 text-white text-sm font-medium rounded-md hover:bg-indigo-700 transition">
                View Detailed Results â†’
            </a>
        </div>
    </div>
</div>